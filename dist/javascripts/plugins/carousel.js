define(["exports"],function(t){"use strict";function i(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var e=function(){function t(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,e,s){return e&&t(i.prototype,e),s&&t(i,s),i}}(),s={count:1,slideTime:.25,autoTimer:0,reverse:!0,width:void 0,height:void 0,direction:"horizontal",isLoop:!1,autoHide:"hide",prevBtn:void 0,nextBtn:void 0,index:0,pagination:!0,mousewheel:!1,preSlideFn:null,startSlideFn:null,callback:null},n=function(){function t(e,n){i(this,t),Object.assign(this,s,n),this.itemIndex=this.isLoop?this.count+this.index:this.index,this.isScroll=!1,this.events=[],this.init(e)}return e(t,[{key:"init",value:function(t){this.elem=t,this.prevBtn=this.prevBtn?document.querySelector(this.prevBtn):t.querySelector(".carousel-prevBtn"),this.nextBtn=this.nextBtn?document.querySelector(this.nextBtn):t.querySelector(".carousel-nextBtn"),this.wrap=t.querySelector(".carousel-wrap"),this.items=Array.from(this.wrap.querySelectorAll(".carousel-slide")),this.total=this.items.length,this.elem.classList.add("horizontal"===this.direction?"carousel-horizontal":"carousel-vertical"),this.initSize(),this.isLoop&&this.addSlide(),this.pagination&&this.createPagination(),this.initPos(),this.autoHide&&this.autoHideBtn()}},{key:"initSize",value:function(){var t=this;this.width&&(this.elem.style.width="number"==typeof this.width?this.width+"px":this.width),this.height&&(this.elem.style.height="number"==typeof this.height?this.height+"px":this.height),this.itemSize=100/this.count+"%",Array.from(this.items,function(i){return i.style["flex-basis"]=t.itemSize})}},{key:"addSlide",value:function(){for(var t=this,i=this.items.slice(this.total-this.count),e=i.length-1;e>=0;e--)this.wrap.insertBefore(i[e].cloneNode(!0),this.wrap.firstChild);Array.from(this.items.slice(0,this.count),function(i){return t.wrap.appendChild(i.cloneNode(!0))})}},{key:"initPos",value:function(){this.pos=-this.itemIndex,this.bindEvent(),this.setPosition(),this.setTransitionTime(this.slideTime)}},{key:"eventControl",value:function(t,i,e){var s;"mousewheel"===i&&void 0!==document.mozHidden&&(i="DOMMouseScroll");for(var n=arguments.length,o=Array(n>3?n-3:0),h=3;h<n;h++)o[h-3]=arguments[h];e=(s=e).bind.apply(s,[this].concat(o)),t.addEventListener(i,e,!1),this.events.push(function(){return t.removeEventListener(i,e,!1)})}},{key:"bindEvent",value:function(){var t=this;this.prevBtn&&this.eventControl(this.prevBtn,"click",this.slidePrev),this.nextBtn&&this.eventControl(this.nextBtn,"click",this.slideNext),this.mousewheel&&this.eventControl(this.wrap,"mousewheel",this.scrollSlide),this.eventControl(this.wrap,"transitionend",this.slideEnd),this.autoTimer&&(this.timer=setInterval(function(){return t.slide(t.reverse?1:-1,"auto")},this.autoTimer))}},{key:"destoryEvent",value:function(){for(;this.events.length;)this.events.shift()()}},{key:"destory",value:function(){this.destoryEvent(),this.elem.parentNode.removeChild(this.elem)}},{key:"slide",value:function(t,i){if(!t||this.isScroll)return!1;if(this.preSlideFn&&!this.preSlideFn(this))return!1;if("click"===i&&(clearInterval(this.timer),this.timer=null),!this.isLoop){var e=this.itemIndex-t;if(e>=this.total||e<0)return!1}this.index-=t,this.itemIndex-=t,this.pos=this.pos+t,this.isScroll=!0,this.setPosition(),this.pagination&&this.setPaginationActive(),this.autoHide&&this.autoHideBtn(),this.startSlideFn&&this.startSlideFn(this)}},{key:"slidePrev",value:function(){this.slide(1,"click")}},{key:"slideNext",value:function(){this.slide(-1,"click")}},{key:"scrollSlide",value:function(t){var i=this,e=void 0,s=t.type;return"DOMMouseScroll"!=s&&"mousewheel"!=s||(e=t.wheelDelta?t.wheelDelta/120:-(t.detail||0)/3),(this.isScroll||this.isLoop||!this.isLoop&&(this.itemIndex!==this.total-this.count&&e<0||0!==this.itemIndex&&e>0))&&t.preventDefault(),1===+this.mousewheel?this.slide(e,"click"):void(this.mousewheelTimer?(this.curDelta+=e,this.curDelta===e*+this.mousewheel&&this.slide(e,"click")):(this.curDelta=e,this.mousewheelTimer=setTimeout(function(){i.curDelta=0,i.mousewheelTimer=null},300)))}},{key:"slideTo",value:function(t){return t=(t+this.total)%this.total,t!==this.index&&void this.slide(this.index-t,"click")}},{key:"slideEnd",value:function(){var t=this;this.autoTimer&&!this.timer&&(this.timer=setInterval(function(){return t.slide(t.reverse?1:-1,"auto")},this.autoTimer));var i=this.isEnd();this.isLoop&&i&&(1===i?(this.pos=-this.total,this.itemIndex=this.total,this.index=this.total-1):(this.pos=-this.count,this.itemIndex=this.count,this.index=0),this.setTransitionTime(0),this.setPosition(),this.elem.offsetWidth,this.setTransitionTime(this.slideTime)),this.isScroll=!1,this.callback&&this.callback(this)}},{key:"setPosition",value:function(){var t=this.pos*(100/this.count),i="horizontal"===this.direction?"translate3d("+t+"%, 0%, 0)":"translate3d(0%, "+t+"%, 0)";this.wrap.style.transform=i,this.wrap.style.webkitTransform=i}},{key:"setTransitionTime",value:function(t){this.wrap.style.transitionDuration=t+"s",this.wrap.style.webkitTransitionDuration=t+"s"}},{key:"autoHideBtn",value:function(){!this.isLoop&&this.autoHide&&(this.itemIndex===this.total-this.count&&this.nextBtn&&this.nextBtn.classList.add("hide"),0===this.itemIndex&&this.prevBtn&&this.prevBtn.classList.add("hide"),this.itemIndex>0&&this.prevBtn&&this.prevBtn.classList.remove("hide"),this.itemIndex<this.total-this.count&&this.nextBtn&&this.nextBtn.classList.remove("hide"))}},{key:"isEnd",value:function(){return 0===this.itemIndex?1:this.itemIndex===this.total+this.count?2:0}},{key:"createPagination",value:function(t){this.pages=document.createElement("UL"),this.pages.className="carousel-pagination"+("string"==typeof this.pagination?" "+this.pagination:"");for(var i="",e=0;e<this.total;e++)i+='<li class="carousel-pagination-bullet"></li>';this.pages.innerHTML=i,this.elem.appendChild(this.pages),this.eventControl(this.pages,"click",this.clickPagination),this.curBullet=this.pages.children[this.index],this.curBullet.classList.add("carousel-pagination-bullet-active")}},{key:"setPaginationActive",value:function(){this.curBullet.classList.remove("carousel-pagination-bullet-active"),this.curBullet=this.pages.children[(this.index+this.total)%this.total],this.curBullet.classList.add("carousel-pagination-bullet-active")}},{key:"clickPagination",value:function(t){var i=t.target;if(!i.classList.contains("carousel-pagination-bullet"))return!1;i=i.previousSibling;for(var e=0;i;)i=i.previousSibling,e++;this.slideTo(e)}}]),t}(),o=function(t,i){function e(t){return t.carousel?t.carousel:t.carousel=new n(t,i)}var s=document.querySelectorAll(t);return console.log(t),1===s.length?e(s[0]):Array.from(s,e)};t["default"]=o});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBsdWdpbnMvY2Fyb3VzZWwuanMiXSwibmFtZXMiOlsiZGVmaW5lIiwiZXhwb3J0cyIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJwcm90b3R5cGUiLCJfZGVmYXVsdCIsImNvdW50Iiwic2xpZGVUaW1lIiwiYXV0b1RpbWVyIiwicmV2ZXJzZSIsIndpZHRoIiwidW5kZWZpbmVkIiwiaGVpZ2h0IiwiZGlyZWN0aW9uIiwiaXNMb29wIiwiYXV0b0hpZGUiLCJwcmV2QnRuIiwibmV4dEJ0biIsImluZGV4IiwicGFnaW5hdGlvbiIsIm1vdXNld2hlZWwiLCJwcmVTbGlkZUZuIiwic3RhcnRTbGlkZUZuIiwiY2FsbGJhY2siLCJDYXJvdXNlbCIsImVsZW0iLCJvcHRpb24iLCJ0aGlzIiwiYXNzaWduIiwiaXRlbUluZGV4IiwiaXNTY3JvbGwiLCJldmVudHMiLCJpbml0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwid3JhcCIsIml0ZW1zIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsInRvdGFsIiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5pdFNpemUiLCJhZGRTbGlkZSIsImNyZWF0ZVBhZ2luYXRpb24iLCJpbml0UG9zIiwiYXV0b0hpZGVCdG4iLCJfdGhpcyIsInN0eWxlIiwiaXRlbVNpemUiLCJfdGhpczIiLCJoZWFkZXJzIiwic2xpY2UiLCJpbnNlcnRCZWZvcmUiLCJjbG9uZU5vZGUiLCJmaXJzdENoaWxkIiwidiIsImFwcGVuZENoaWxkIiwicG9zIiwiYmluZEV2ZW50Iiwic2V0UG9zaXRpb24iLCJzZXRUcmFuc2l0aW9uVGltZSIsInR5cGUiLCJmbiIsIl9mbiIsIm1vekhpZGRlbiIsIl9sZW4iLCJhcmd1bWVudHMiLCJhcmciLCJfa2V5IiwiYmluZCIsImFwcGx5IiwiY29uY2F0IiwiYWRkRXZlbnRMaXN0ZW5lciIsInB1c2giLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiX3RoaXMzIiwiZXZlbnRDb250cm9sIiwic2xpZGVQcmV2Iiwic2xpZGVOZXh0Iiwic2Nyb2xsU2xpZGUiLCJzbGlkZUVuZCIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJzbGlkZSIsInNoaWZ0IiwiZGVzdG9yeUV2ZW50IiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwiZGlyIiwiY2xlYXJJbnRlcnZhbCIsInN0YXR1cyIsInNldFBhZ2luYXRpb25BY3RpdmUiLCJlIiwiX3RoaXM0IiwiZGVsdGEiLCJ3aGVlbERlbHRhIiwiZGV0YWlsIiwicHJldmVudERlZmF1bHQiLCJtb3VzZXdoZWVsVGltZXIiLCJjdXJEZWx0YSIsInNldFRpbWVvdXQiLCJfdGhpczUiLCJpc0VuZCIsIm9mZnNldFdpZHRoIiwibW92ZURpc3RhbmNlIiwidHJhbnNmb3JtIiwid2Via2l0VHJhbnNmb3JtIiwidGltZSIsInRyYW5zaXRpb25EdXJhdGlvbiIsIndlYmtpdFRyYW5zaXRpb25EdXJhdGlvbiIsInJlbW92ZSIsImNsYXNzTmFtZSIsInBhZ2VzIiwiY3JlYXRlRWxlbWVudCIsInN0ciIsImlubmVySFRNTCIsImNsaWNrUGFnaW5hdGlvbiIsImN1ckJ1bGxldCIsImNoaWxkcmVuIiwiY29udGFpbnMiLCJwcmV2aW91c1NpYmxpbmciLCJzbGlkZVRvIiwiZW50cnkiLCJzZWxlY3RvciIsImNyZWF0ZUNhcm91c2VsIiwiY2Fyb3VzZWwiLCJlbGVtcyIsImNvbnNvbGUiLCJsb2ciXSwibWFwcGluZ3MiOiJBQUFBQSxRQUFRLFdBQVksU0FBVUMsR0FBOUIsWUFPQyxTQUFTQyxHQUFnQkMsRUFBVUMsR0FD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Q3ZCLE1BQUlBLEdBQUtzRyxTQUNEdEcsRUFBS3NHLFNBRUx0RyxFQUFLc0csU0FBVyxHQUFJdkcsR0FBU0MsRUFBTUMsR0FUNUMsR0FBSXNHLEdBQVEvRixTQUFTTSxpQkFBaUJzRixFQUV0QyxPQURBSSxTQUFRQyxJQUFJTCxHQUNTLElBQWpCRyxFQUFNcEksT0FBcUJrSSxFQUFlRSxFQUFNLElBQzdDM0YsTUFBTUMsS0FBSzBGLEVBQU9GLEdBbUh6Qi9JLEdBQUFBLFdBeEdjNkkiLCJmaWxlIjoicGx1Z2lucy9jYXJvdXNlbC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcclxuXHJcbmxldCBfZGVmYXVsdCA9IHtcclxuXHRjb3VudDogMSxcclxuXHRzbGlkZVRpbWU6IDAuMjUsXHJcblx0YXV0b1RpbWVyOiAwLFxyXG5cdHJldmVyc2U6IHRydWUsXHJcblx0d2lkdGg6IHVuZGVmaW5lZCxcclxuXHRoZWlnaHQ6IHVuZGVmaW5lZCxcclxuXHRkaXJlY3Rpb246ICdob3Jpem9udGFsJyxcclxuXHRpc0xvb3A6IGZhbHNlLFxyXG5cdGF1dG9IaWRlOiAnaGlkZScsXHJcblx0cHJldkJ0bjogdW5kZWZpbmVkLFxyXG5cdG5leHRCdG46IHVuZGVmaW5lZCxcclxuXHRpbmRleDogMCxcclxuXHRwYWdpbmF0aW9uOiB0cnVlLFxyXG5cdG1vdXNld2hlZWw6IGZhbHNlLFxyXG5cdHByZVNsaWRlRm46IG51bGwsXHJcblx0c3RhcnRTbGlkZUZuOiBudWxsLFxyXG5cdGNhbGxiYWNrOiBudWxsLFxyXG59XHJcblxyXG5jbGFzcyBDYXJvdXNlbCB7XHJcblx0Y29uc3RydWN0b3IoZWxlbSwgb3B0aW9uKSB7XHJcblx0XHRPYmplY3QuYXNzaWduKHRoaXMsIF9kZWZhdWx0LCBvcHRpb24pO1xyXG5cdFx0dGhpcy5pdGVtSW5kZXggPSB0aGlzLmlzTG9vcCA/ICh0aGlzLmNvdW50ICsgdGhpcy5pbmRleCkgOiB0aGlzLmluZGV4O1xyXG5cdFx0dGhpcy5pc1Njcm9sbCA9IGZhbHNlO1xyXG5cdFx0dGhpcy5ldmVudHMgPSBbXTtcclxuXHRcdHRoaXMuaW5pdChlbGVtKTtcclxuXHR9XHJcblx0aW5pdChlbGVtKSB7XHJcblx0XHR0aGlzLmVsZW0gPSBlbGVtO1xyXG5cdFx0dGhpcy5wcmV2QnRuID0gdGhpcy5wcmV2QnRuID8gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLnByZXZCdG4pIDogZWxlbS5xdWVyeVNlbGVjdG9yKCcuY2Fyb3VzZWwtcHJldkJ0bicpO1xyXG5cdFx0dGhpcy5uZXh0QnRuID0gdGhpcy5uZXh0QnRuID8gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLm5leHRCdG4pIDogZWxlbS5xdWVyeVNlbGVjdG9yKCcuY2Fyb3VzZWwtbmV4dEJ0bicpO1xyXG5cdFx0dGhpcy53cmFwID0gZWxlbS5xdWVyeVNlbGVjdG9yKCcuY2Fyb3VzZWwtd3JhcCcpO1xyXG5cdFx0dGhpcy5pdGVtcyA9IEFycmF5LmZyb20odGhpcy53cmFwLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYXJvdXNlbC1zbGlkZScpKTtcclxuXHRcdHRoaXMudG90YWwgPSB0aGlzLml0ZW1zLmxlbmd0aDtcclxuXHRcdHRoaXMuZWxlbS5jbGFzc0xpc3QuYWRkKHRoaXMuZGlyZWN0aW9uID09PSAnaG9yaXpvbnRhbCcgPyAnY2Fyb3VzZWwtaG9yaXpvbnRhbCcgOiAnY2Fyb3VzZWwtdmVydGljYWwnKTtcclxuXHJcblx0XHR0aGlzLmluaXRTaXplKCk7XHJcblx0XHR0aGlzLmlzTG9vcCAmJiB0aGlzLmFkZFNsaWRlKCk7XHJcblx0XHR0aGlzLnBhZ2luYXRpb24gJiYgdGhpcy5jcmVhdGVQYWdpbmF0aW9uKCk7XHJcblx0XHR0aGlzLmluaXRQb3MoKTtcclxuXHRcdHRoaXMuYXV0b0hpZGUgJiYgdGhpcy5hdXRvSGlkZUJ0bigpO1xyXG5cdH1cclxuXHRpbml0U2l6ZSgpIHtcclxuXHRcdGlmICh0aGlzLndpZHRoKSB7XHJcblx0XHRcdHRoaXMuZWxlbS5zdHlsZS53aWR0aCA9IHR5cGVvZiB0aGlzLndpZHRoID09PSAnbnVtYmVyJyA/ICh0aGlzLndpZHRoICsgJ3B4JykgOiB0aGlzLndpZHRoO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHRoaXMuaGVpZ2h0KSB7XHJcblx0XHRcdHRoaXMuZWxlbS5zdHlsZS5oZWlnaHQgPSB0eXBlb2YgdGhpcy5oZWlnaHQgPT09ICdudW1iZXInID8gKHRoaXMuaGVpZ2h0ICsgJ3B4JykgOiB0aGlzLmhlaWdodDtcclxuXHRcdH1cclxuXHRcdHRoaXMuaXRlbVNpemUgPSAoMTAwIC8gdGhpcy5jb3VudCkgKyAnJSc7XHJcblx0XHRBcnJheS5mcm9tKHRoaXMuaXRlbXMsIChlbGVtKSA9PiBlbGVtLnN0eWxlWydmbGV4LWJhc2lzJ10gPSB0aGlzLml0ZW1TaXplKTtcclxuXHR9XHJcblx0YWRkU2xpZGUoKSB7XHJcblx0XHRsZXQgaGVhZGVycyA9IHRoaXMuaXRlbXMuc2xpY2UodGhpcy50b3RhbCAtIHRoaXMuY291bnQpO1xyXG5cdFx0Zm9yIChsZXQgaSA9IGhlYWRlcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuXHRcdFx0dGhpcy53cmFwLmluc2VydEJlZm9yZShoZWFkZXJzW2ldLmNsb25lTm9kZSh0cnVlKSwgdGhpcy53cmFwLmZpcnN0Q2hpbGQpXHJcblx0XHR9XHJcblx0XHRBcnJheS5mcm9tKHRoaXMuaXRlbXMuc2xpY2UoMCwgdGhpcy5jb3VudCksICh2KSA9PiB0aGlzLndyYXAuYXBwZW5kQ2hpbGQodi5jbG9uZU5vZGUodHJ1ZSkpKTtcclxuXHR9XHJcblx0aW5pdFBvcygpIHtcclxuXHRcdHRoaXMucG9zID0gLXRoaXMuaXRlbUluZGV4O1xyXG5cdFx0dGhpcy5iaW5kRXZlbnQoKTtcclxuXHRcdHRoaXMuc2V0UG9zaXRpb24oKTtcclxuXHRcdHRoaXMuc2V0VHJhbnNpdGlvblRpbWUodGhpcy5zbGlkZVRpbWUpO1xyXG5cdH1cclxuXHRldmVudENvbnRyb2woZWxlbSwgdHlwZSwgZm4sIC4uLmFyZykge1xyXG5cdFx0aWYgKHR5cGUgPT09IFwibW91c2V3aGVlbFwiICYmIGRvY3VtZW50Lm1vekhpZGRlbiAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdHR5cGUgPSBcIkRPTU1vdXNlU2Nyb2xsXCI7XHJcblx0XHR9XHJcblx0XHRmbiA9IGZuLmJpbmQodGhpcywgLi4uYXJnKTtcclxuXHRcdGVsZW0uYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBmbiwgZmFsc2UpO1xyXG5cdFx0dGhpcy5ldmVudHMucHVzaCgoKSA9PiBlbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgZm4sIGZhbHNlKSk7XHJcblx0fVxyXG5cdGJpbmRFdmVudCgpIHtcclxuXHRcdHRoaXMucHJldkJ0biAmJiB0aGlzLmV2ZW50Q29udHJvbCh0aGlzLnByZXZCdG4sICdjbGljaycsIHRoaXMuc2xpZGVQcmV2KTtcclxuXHRcdHRoaXMubmV4dEJ0biAmJiB0aGlzLmV2ZW50Q29udHJvbCh0aGlzLm5leHRCdG4sICdjbGljaycsIHRoaXMuc2xpZGVOZXh0KTtcclxuXHRcdHRoaXMubW91c2V3aGVlbCAmJiB0aGlzLmV2ZW50Q29udHJvbCh0aGlzLndyYXAsICdtb3VzZXdoZWVsJywgdGhpcy5zY3JvbGxTbGlkZSk7XHJcblx0XHR0aGlzLmV2ZW50Q29udHJvbCh0aGlzLndyYXAsICd0cmFuc2l0aW9uZW5kJywgdGhpcy5zbGlkZUVuZCk7XHJcblx0XHRpZiAodGhpcy5hdXRvVGltZXIpIHtcclxuXHRcdFx0dGhpcy50aW1lciA9IHNldEludGVydmFsKCgpID0+IHRoaXMuc2xpZGUodGhpcy5yZXZlcnNlID8gMSA6IC0xLCAnYXV0bycpLCB0aGlzLmF1dG9UaW1lcik7XHJcblx0XHR9XHJcblx0fVxyXG5cdGRlc3RvcnlFdmVudCgpIHtcclxuXHRcdHdoaWxlKHRoaXMuZXZlbnRzLmxlbmd0aCl7XHJcblx0XHRcdCh0aGlzLmV2ZW50cy5zaGlmdCgpKSgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRkZXN0b3J5KCkge1xyXG5cdFx0dGhpcy5kZXN0b3J5RXZlbnQoKTtcclxuXHRcdHRoaXMuZWxlbS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZWxlbSk7XHJcblx0fVxyXG5cdHNsaWRlKGRpciwgdHlwZSkge1xyXG5cdFx0aWYgKCFkaXIgfHwgdGhpcy5pc1Njcm9sbCkge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5wcmVTbGlkZUZuICYmICF0aGlzLnByZVNsaWRlRm4odGhpcykpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHR5cGUgPT09ICdjbGljaycpIHtcclxuXHRcdFx0Y2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVyKTtcclxuXHRcdFx0dGhpcy50aW1lciA9IG51bGw7XHJcblx0XHR9XHJcblx0XHRpZiAoIXRoaXMuaXNMb29wKSB7XHJcblx0XHRcdGxldCBzdGF0dXMgPSB0aGlzLml0ZW1JbmRleCAtIGRpcjtcclxuXHRcdFx0aWYgKHN0YXR1cyA+PSB0aGlzLnRvdGFsIHx8IHN0YXR1cyA8IDApIHtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHRoaXMuaW5kZXggLT0gZGlyO1xyXG5cdFx0dGhpcy5pdGVtSW5kZXggLT0gZGlyO1xyXG5cdFx0dGhpcy5wb3MgPSB0aGlzLnBvcyArIGRpcjtcclxuXHRcdHRoaXMuaXNTY3JvbGwgPSB0cnVlO1xyXG5cdFx0dGhpcy5zZXRQb3NpdGlvbigpO1xyXG5cdFx0dGhpcy5wYWdpbmF0aW9uICYmIHRoaXMuc2V0UGFnaW5hdGlvbkFjdGl2ZSgpO1xyXG5cdFx0dGhpcy5hdXRvSGlkZSAmJiB0aGlzLmF1dG9IaWRlQnRuKCk7XHJcblx0XHR0aGlzLnN0YXJ0U2xpZGVGbiAmJiB0aGlzLnN0YXJ0U2xpZGVGbih0aGlzKTtcclxuXHR9XHJcblx0c2xpZGVQcmV2KCkge1xyXG5cdFx0dGhpcy5zbGlkZSgxLCAnY2xpY2snKTtcclxuXHR9XHJcblx0c2xpZGVOZXh0KCkge1xyXG5cdFx0dGhpcy5zbGlkZSgtMSwgJ2NsaWNrJyk7XHJcblx0fVxyXG5cdHNjcm9sbFNsaWRlKGUpIHtcclxuXHRcdGxldCBkZWx0YSwgdHlwZSA9IGUudHlwZTtcclxuXHRcdGlmICh0eXBlID09ICdET01Nb3VzZVNjcm9sbCcgfHwgdHlwZSA9PSAnbW91c2V3aGVlbCcpIHtcclxuXHRcdFx0ZGVsdGEgPSAoZS53aGVlbERlbHRhKSA/IGUud2hlZWxEZWx0YSAvIDEyMCA6IC0oZS5kZXRhaWwgfHwgMCkgLyAzO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHRoaXMuaXNTY3JvbGwgfHwgdGhpcy5pc0xvb3AgfHwgKCF0aGlzLmlzTG9vcCAmJiAoKHRoaXMuaXRlbUluZGV4ICE9PSB0aGlzLnRvdGFsIC0gdGhpcy5jb3VudCAmJiBkZWx0YSA8IDApIHx8ICh0aGlzLml0ZW1JbmRleCAhPT0gMCAmJiBkZWx0YSA+IDApKSkpIHtcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKCt0aGlzLm1vdXNld2hlZWwgPT09IDEpIHJldHVybiB0aGlzLnNsaWRlKGRlbHRhLCAnY2xpY2snKTtcclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRpZiAodGhpcy5tb3VzZXdoZWVsVGltZXIpIHtcclxuXHRcdFx0XHR0aGlzLmN1ckRlbHRhICs9IGRlbHRhO1xyXG5cdFx0XHRcdGlmICh0aGlzLmN1ckRlbHRhID09PSBkZWx0YSAqICsodGhpcy5tb3VzZXdoZWVsKSkge1xyXG5cdFx0XHRcdFx0dGhpcy5zbGlkZShkZWx0YSwgJ2NsaWNrJyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuY3VyRGVsdGEgPSBkZWx0YTtcclxuXHRcdFx0XHR0aGlzLm1vdXNld2hlZWxUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5jdXJEZWx0YSA9IDA7XHJcblx0XHRcdFx0XHR0aGlzLm1vdXNld2hlZWxUaW1lciA9IG51bGw7XHJcblx0XHRcdFx0fSwgMzAwKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRzbGlkZVRvKGluZGV4KSB7XHJcblx0XHRpbmRleCA9IChpbmRleCArIHRoaXMudG90YWwpICUgdGhpcy50b3RhbDtcclxuXHRcdGlmIChpbmRleCA9PT0gdGhpcy5pbmRleCkgcmV0dXJuIGZhbHNlO1xyXG5cdFx0dGhpcy5zbGlkZSh0aGlzLmluZGV4IC0gaW5kZXgsICdjbGljaycpO1xyXG5cdH1cclxuXHRzbGlkZUVuZCgpIHtcclxuXHRcdGlmICh0aGlzLmF1dG9UaW1lciAmJiAhdGhpcy50aW1lcikge1xyXG5cdFx0XHR0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gdGhpcy5zbGlkZSh0aGlzLnJldmVyc2UgPyAxIDogLTEsICdhdXRvJyksIHRoaXMuYXV0b1RpbWVyKTtcclxuXHRcdH1cclxuXHRcdGxldCBzdGF0dXMgPSB0aGlzLmlzRW5kKCk7XHJcblx0XHRpZiAodGhpcy5pc0xvb3AgJiYgc3RhdHVzKSB7XHJcblx0XHRcdGlmIChzdGF0dXMgPT09IDEpIHtcclxuXHRcdFx0XHR0aGlzLnBvcyA9IC10aGlzLnRvdGFsO1xyXG5cdFx0XHRcdHRoaXMuaXRlbUluZGV4ID0gdGhpcy50b3RhbDtcclxuXHRcdFx0XHR0aGlzLmluZGV4ID0gdGhpcy50b3RhbCAtIDE7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5wb3MgPSAtdGhpcy5jb3VudDtcclxuXHRcdFx0XHR0aGlzLml0ZW1JbmRleCA9IHRoaXMuY291bnQ7XHJcblx0XHRcdFx0dGhpcy5pbmRleCA9IDA7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5zZXRUcmFuc2l0aW9uVGltZSgwKTtcclxuXHRcdFx0dGhpcy5zZXRQb3NpdGlvbigpO1xyXG5cdFx0XHR0aGlzLmVsZW0ub2Zmc2V0V2lkdGg7XHJcblx0XHRcdHRoaXMuc2V0VHJhbnNpdGlvblRpbWUodGhpcy5zbGlkZVRpbWUpO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5pc1Njcm9sbCA9IGZhbHNlO1xyXG5cdFx0dGhpcy5jYWxsYmFjayAmJiB0aGlzLmNhbGxiYWNrKHRoaXMpO1xyXG5cdH1cclxuXHRzZXRQb3NpdGlvbigpIHtcclxuXHRcdGxldCBtb3ZlRGlzdGFuY2UgPSB0aGlzLnBvcyAqICgxMDAgLyB0aGlzLmNvdW50KTtcclxuXHRcdGxldCB0cmFuc2Zvcm0gPSB0aGlzLmRpcmVjdGlvbiA9PT0gJ2hvcml6b250YWwnID8gJ3RyYW5zbGF0ZTNkKCcgKyBtb3ZlRGlzdGFuY2UgKyAnJSwgMCUsIDApJyA6ICd0cmFuc2xhdGUzZCgwJSwgJyArIG1vdmVEaXN0YW5jZSArICclLCAwKSc7XHJcblx0XHR0aGlzLndyYXAuc3R5bGUudHJhbnNmb3JtID0gdHJhbnNmb3JtO1xyXG5cdFx0dGhpcy53cmFwLnN0eWxlLndlYmtpdFRyYW5zZm9ybSA9IHRyYW5zZm9ybTtcclxuXHR9XHJcblx0c2V0VHJhbnNpdGlvblRpbWUodGltZSkge1xyXG5cdFx0dGhpcy53cmFwLnN0eWxlLnRyYW5zaXRpb25EdXJhdGlvbiA9IHRpbWUgKyAncyc7XHJcblx0XHR0aGlzLndyYXAuc3R5bGUud2Via2l0VHJhbnNpdGlvbkR1cmF0aW9uID0gdGltZSArICdzJztcclxuXHR9XHJcblx0YXV0b0hpZGVCdG4oKSB7XHJcblx0XHRpZiAoIXRoaXMuaXNMb29wICYmIHRoaXMuYXV0b0hpZGUpIHtcclxuXHRcdFx0aWYgKHRoaXMuaXRlbUluZGV4ID09PSB0aGlzLnRvdGFsIC0gdGhpcy5jb3VudCkge1xyXG5cdFx0XHRcdHRoaXMubmV4dEJ0biAmJiB0aGlzLm5leHRCdG4uY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICh0aGlzLml0ZW1JbmRleCA9PT0gMCkge1xyXG5cdFx0XHRcdHRoaXMucHJldkJ0biAmJiB0aGlzLnByZXZCdG4uY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICh0aGlzLml0ZW1JbmRleCA+IDApIHtcclxuXHRcdFx0XHR0aGlzLnByZXZCdG4gJiYgdGhpcy5wcmV2QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAodGhpcy5pdGVtSW5kZXggPCB0aGlzLnRvdGFsIC0gdGhpcy5jb3VudCkge1xyXG5cdFx0XHRcdHRoaXMubmV4dEJ0biAmJiB0aGlzLm5leHRCdG4uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdGlzRW5kKCkge1xyXG5cdFx0aWYgKHRoaXMuaXRlbUluZGV4ID09PSAwKSB7XHJcblx0XHRcdHJldHVybiAxO1xyXG5cdFx0fSBlbHNlIGlmICh0aGlzLml0ZW1JbmRleCA9PT0gKHRoaXMudG90YWwgKyB0aGlzLmNvdW50KSkge1xyXG5cdFx0XHRyZXR1cm4gMjtcclxuXHRcdH1cclxuXHRcdHJldHVybiAwO1xyXG5cdH1cclxuXHRjcmVhdGVQYWdpbmF0aW9uKGNsYXNzTmFtZSkge1xyXG5cdFx0dGhpcy5wYWdlcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1VMJyk7XHJcblx0XHR0aGlzLnBhZ2VzLmNsYXNzTmFtZSA9IGBjYXJvdXNlbC1wYWdpbmF0aW9uJHt0eXBlb2YgdGhpcy5wYWdpbmF0aW9uID09PSAnc3RyaW5nJyA/ICgnICcgKyB0aGlzLnBhZ2luYXRpb24pIDogJyd9YDtcclxuXHRcdGxldCBzdHIgPSAnJztcclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50b3RhbDsgaSsrKSB7XHJcblx0XHRcdHN0ciArPSBgPGxpIGNsYXNzPVwiY2Fyb3VzZWwtcGFnaW5hdGlvbi1idWxsZXRcIj48L2xpPmA7XHJcblx0XHR9XHJcblx0XHR0aGlzLnBhZ2VzLmlubmVySFRNTCA9IHN0cjtcclxuXHRcdHRoaXMuZWxlbS5hcHBlbmRDaGlsZCh0aGlzLnBhZ2VzKTtcclxuXHJcblx0XHR0aGlzLmV2ZW50Q29udHJvbCh0aGlzLnBhZ2VzLCAnY2xpY2snLCB0aGlzLmNsaWNrUGFnaW5hdGlvbik7XHJcblxyXG5cdFx0dGhpcy5jdXJCdWxsZXQgPSB0aGlzLnBhZ2VzLmNoaWxkcmVuW3RoaXMuaW5kZXhdO1xyXG5cdFx0dGhpcy5jdXJCdWxsZXQuY2xhc3NMaXN0LmFkZCgnY2Fyb3VzZWwtcGFnaW5hdGlvbi1idWxsZXQtYWN0aXZlJyk7XHJcblx0fVxyXG5cdHNldFBhZ2luYXRpb25BY3RpdmUoKSB7XHJcblx0XHR0aGlzLmN1ckJ1bGxldC5jbGFzc0xpc3QucmVtb3ZlKCdjYXJvdXNlbC1wYWdpbmF0aW9uLWJ1bGxldC1hY3RpdmUnKTtcclxuXHRcdHRoaXMuY3VyQnVsbGV0ID0gdGhpcy5wYWdlcy5jaGlsZHJlblsodGhpcy5pbmRleCArIHRoaXMudG90YWwpICUgdGhpcy50b3RhbF07XHJcblx0XHR0aGlzLmN1ckJ1bGxldC5jbGFzc0xpc3QuYWRkKCdjYXJvdXNlbC1wYWdpbmF0aW9uLWJ1bGxldC1hY3RpdmUnKTtcclxuXHR9XHJcblx0Y2xpY2tQYWdpbmF0aW9uKGUpIHtcclxuXHRcdGxldCB0YXJnZXQgPSBlLnRhcmdldDtcclxuXHRcdGlmICghdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY2Fyb3VzZWwtcGFnaW5hdGlvbi1idWxsZXQnKSkgcmV0dXJuIGZhbHNlO1xyXG5cdFx0dGFyZ2V0ID0gdGFyZ2V0LnByZXZpb3VzU2libGluZztcclxuXHRcdGxldCBpID0gMDtcclxuXHRcdHdoaWxlICh0YXJnZXQpIHtcclxuXHRcdFx0dGFyZ2V0ID0gdGFyZ2V0LnByZXZpb3VzU2libGluZztcclxuXHRcdFx0aSsrO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5zbGlkZVRvKGkpO1xyXG5cdH1cclxufVxyXG5cclxuY29uc3QgZW50cnkgPSAoc2VsZWN0b3IsIG9wdGlvbikgPT4ge1xyXG5cdGxldCBlbGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpO1xyXG5cdGNvbnNvbGUubG9nKHNlbGVjdG9yKTtcclxuXHRpZiAoZWxlbXMubGVuZ3RoID09PSAxKSByZXR1cm4gY3JlYXRlQ2Fyb3VzZWwoZWxlbXNbMF0pO1xyXG5cdHJldHVybiBBcnJheS5mcm9tKGVsZW1zLCBjcmVhdGVDYXJvdXNlbCk7XHJcblxyXG5cdGZ1bmN0aW9uIGNyZWF0ZUNhcm91c2VsKGVsZW0pIHtcclxuXHRcdGlmIChlbGVtLmNhcm91c2VsKSB7XHJcblx0XHRcdHJldHVybiBlbGVtLmNhcm91c2VsO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0cmV0dXJuIGVsZW0uY2Fyb3VzZWwgPSBuZXcgQ2Fyb3VzZWwoZWxlbSwgb3B0aW9uKTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGVudHJ5OyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
